---
 - name: windows hardening
   hosts: all
   gather_facts: false
   ignore_errors: True
   tasks:
     - name: Change the MinimumPasswordAge
       win_security_policy:
         section: System Access
         key: MinimumPasswordAge
         value: 2

     - name:  Change the MaximumPasswordAge
       win_security_policy:
         section: System Access
         key: MaximumPasswordAge
         value: 42

     - name: Change the MinimumPasswordLength
       win_security_policy:
         section: System Access
         key: MinimumPasswordLength
         value: 8
        
     - name: Change the PasswordComplexity
       win_security_policy:
         section: System Access
         key: PasswordComplexity
         value: 1

     - name: Change the MinimumPasswordAge
       win_security_policy:
         section: System Access
         key: MinimumPasswordAge
         value: 2

     - name:  Change the PasswordHistorySize
       win_security_policy:
         section: System Access
         key: PasswordHistorySize
         value: 24

     - name: Change the LockoutBadCount
       win_security_policy:
         section: System Access
         key: LockoutBadCount
         value: 0
        

     - name:  Change the RequireLogonToChangePassword
       win_security_policy:
         section: System Access
         key: RequireLogonToChangePassword
         value: 0

     - name: Change the ForceLogoffWhenHourExpire
       win_security_policy:
         section: System Access
         key: ForceLogoffWhenHourExpire
         value: 1
        
     - name: Change the NewAdministratorName
       win_security_policy:
         section: System Access
         key: NewAdministratorName
         value: "_winadmin_"

     - name: Change the NewGuestName
       win_security_policy:
         section: System Access
         key: NewGuestName
         value: "_winguest_"

     - name:  Change the ClearTextPassword
       win_security_policy:
         section: System Access
         key: ClearTextPassword
         value: 0

     - name: Change the LSAAnonymousNameLookup
       win_security_policy:
         section: System Access
         key: LSAAnonymousNameLookup
         value: 0
        
     - name: Change the EnableAdminAccount
       win_security_policy:
         section: System Access
         key: EnableAdminAccount
         value: 1 

     - name: Change the EnableGuestAccount
       win_security_policy:
         section: System Access
         key: EnableGuestAccount
         value: 0 
        
     - name: Change the AuditSystemEvents
       win_security_policy:
         section: Event Audit
         key: AuditSystemEvents
         value: 0 
        
     - name: Change the AuditLogonEvents
       win_security_policy:
         section: Event Audit
         key: AuditLogonEvents
         value: 0 
        
     - name: Change the AuditObjectAccess
       win_security_policy:
         section: Event Audit
         key: AuditObjectAccess
         value: 0 
        
     - name: Change the AuditPrivilegeUse
       win_security_policy:
         section: Event Audit
         key: AuditPrivilegeUse
         value: 0 
        
     - name: Change the AuditPolicyChange
       win_security_policy:
         section: Event Audit
         key: AuditPolicyChange
         value: 0
        
     - name: Change the AuditAccountManage
       win_security_policy:
         section: Event Audit
         key: AuditAccountManage
         value: 0
        
     - name: Change the AuditProcessTracking
       win_security_policy:
         section: Event Audit
         key: AuditProcessTracking
         value: 0 
        
     - name: Change the AuditDSAccess
       win_security_policy:
         section: Event Audit
         key: AuditDSAccess
         value: 0
        
     - name: Change the AuditAccountLogon
       win_security_policy:
         section: Event Audit
         key: AuditAccountLogon
         value: 2

     - name: Change the Recovery console Security Level
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Setup\RecoveryConsole\SecurityLevel
         value: 4,0

     - name: Change the Recovery console Command
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Setup\RecoveryConsole\SetCommand
         value: 4,0

     - name: Change the Allocate CDROms
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\AllocateCDRoms
         value: 1,"1"

     - name: Change the Allocate DASD
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\AllocateDASD
         value: 1,"1"

     - name: Change the Allocate Floppies
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\AllocateFloppies
         value: 1,"1"

     - name: Change the CachedLogons Count
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\CachedLogonsCount
         value: 1,"0"

     - name: Change Force Unlock Logon
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ForceUnlockLogon
         value: 4,0

     - name: Password expiry Warning
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\PasswordExpiryWarning
         value: 4,5

     - name: Change the ScRemoveOption
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ScRemoveOption
         value: 1,"1"

     - name: Change the ConsentPromptBehaviorAdmin
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin
         value: 4,2

     - name: Change the ConsentPromptBehaviorUser
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorUser
         value: 4,0

     - name: Change the DisableCAD
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableCAD
         value: 4,0

     - name: Change the DontDisplayLastUserName
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\DontDisplayLastUserName
         value: 4,1

     - name: EnableLUA
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA
         value: 4,1

     - name: Change the EnableSecureUIAPaths
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableSecureUIAPaths
         value: 4,1

     - name: Change the EnableUIADesktopToggle
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableUIADesktopToggle
         value: 4,0

     - name: Change the EnableVirtualization
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableVirtualization
         value: 4,1

     - name: FilterAdministratorToken
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\FilterAdministratorToken
         value: 4,1

     - name: Change the LegalNoticeCaption
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\LegalNoticeCaption
         value: 1,""

     - name: Change the LegalNoticeText
       win_security_policy:
         section: Registry Values
         key: MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\LegalNoticeText=7,
         value: 7,"Legal Notice"

    